@page "/DeleteBooks"
@using System.Data.SqlClient
@using ModelClass
@using DataAccessLayer
@attribute [Authorize(Roles = "seller")]

<h3>Delete a Book</h3>

<form class="form-horizontal">
    <div class="form-group">
        <label for="title" class="col-sm-4 control-label">Title:</label>
        <div class="col-sm-8">
            <select class="form-control" id="title" @bind="selectedTitle">
                @foreach (var book in books)
                {
                    <option value="@book.title">@book.title</option>
                }
            </select>
        </div>
    </div>
    <div class="form-group">
        <div class="col-sm-offset-4 col-sm-8">
            <button type="button" class="btn btn-danger" @onclick="DeleteBook">Delete</button>
        </div>
    </div>
</form>

@if (deleteSuccess)
{
    <div class="alert alert-success">Book deleted successfully!</div>
}

@code {
    private List<ModelBookListingDetails> books = new List<ModelBookListingDetails>();
    private string selectedTitle;
    private bool deleteSuccess;

    protected override void OnInitialized()
    {
        // Fetch the list of books for the dropdown
        books = DALBookListingDetails.GetBookListingDetails();
    }

    private void DeleteBook()
    {
        DALBookListingDetails dal = new DALBookListingDetails();
        dal.DeleteBookListing(selectedTitle);
        // The DeleteBookListing method doesn't return a boolean value
        // Optionally, you can re-fetch the book list after a successful deletion
        books = DALBookListingDetails.GetBookListingDetails();
        deleteSuccess = true;
    }



}
